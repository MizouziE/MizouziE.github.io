(()=>{var m="/",h=20;(function(){let i=new FlexSearch.Document({document:{id:"id",index:["title","tags","content","date"],store:["title","summary","date","permalink"]},tokenize:"forward"});function f(e){let n=document.querySelector("template").content,t=document.createDocumentFragment(),c=document.querySelector(".search-results");c.textContent="";for(let s in e){let o=e[s],r=n.cloneNode(!0),d=r.querySelector("a"),p=r.querySelector("time"),S=r.querySelector(".content");d.innerHTML=o.title,d.href=o.permalink,p.innerText=o.date,S.innerHTML=o.summary,t.appendChild(r)}c.appendChild(t)}function a(e){let n=e||document.querySelector(".search-text").value.trim(),t=i.search({query:n,enrich:!0,limit:h}),c={};t.forEach(function(s){s.result.forEach(function(o){c[o.doc.permalink]=o.doc})}),f(c)}function q(e){e.addEventListener("submit",function(n){n.preventDefault(),a()}),e.addEventListener("input",function(){a()}),document.querySelector(".search-loading").classList.add("hidden"),document.querySelector(".search-bar").classList.remove("hidden"),document.querySelector(".search-text").focus()}function y(e){let n=m+"index.json";document.querySelector(".search-loading").classList.remove("hidden"),fetch(n).then(function(t){return t.json()}).then(function(t){t.forEach(function(c){i.add(c)})}).then(e)}let u=document.querySelector(".search-form");u&&(y(function(){let e=new URLSearchParams(window.location.search).get("q");document.querySelector(".search-text").value=e||"",a(e)}),q(u))})();})();
